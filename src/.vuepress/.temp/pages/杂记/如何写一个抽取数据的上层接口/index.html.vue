<template><div><p>如何写一个抽取数据的上层接口</p>
<p>需要考虑哪些因素：</p>
<ul>
<li>抽数得考虑成功与否，失败了考虑重试需要一个同步状态去记录</li>
<li>抽数不应该按照当天日期去拿数据，应该是一个时间段，上一次成功的同步结束时间到当前时间，避免遗漏数据</li>
<li>如果数据量特别多，考虑使用多线程，避免客户使用系统时间段同步，影响访问速度</li>
<li>将数据查询到内存中，记得分页，避免oom</li>
<li>小细节：做in查询的时候，小心拼接超长也要分页</li>
</ul>
<p>用一张表去记录，表结构：</p>
<p>表名: db_ywzx.t_zx_sjtbjl</p>
<p>表注释: 数据同步记录</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>数据类型</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td>c_bh</td>
<td>char(32)</td>
<td>主键</td>
</tr>
<tr>
<td>d_tbsj</td>
<td>date</td>
<td>同步时间</td>
</tr>
<tr>
<td>c_tblx</td>
<td>varchar(100)</td>
<td>同步类型</td>
</tr>
<tr>
<td>c_tbfy</td>
<td>varchar(300)</td>
<td>同步法院</td>
</tr>
<tr>
<td>dt_kssj</td>
<td>timestamp</td>
<td>开始时间</td>
</tr>
<tr>
<td>dt_jssj</td>
<td>timestamp</td>
<td>结束时间</td>
</tr>
<tr>
<td>c_zt</td>
<td>varchar(100)</td>
<td>状态</td>
</tr>
<tr>
<td>n_tbjls</td>
<td>integer</td>
<td>同步记录数</td>
</tr>
<tr>
<td>dt_qdsj</td>
<td>timestamp</td>
<td>启动时间</td>
</tr>
<tr>
<td>dt_wcsj</td>
<td>timestamp</td>
<td>完成时间</td>
</tr>
<tr>
<td>n_zhxgfs</td>
<td>integer</td>
<td>最后修改方式</td>
</tr>
<tr>
<td>c_cjr</td>
<td>varchar(300)</td>
<td>创建人</td>
</tr>
<tr>
<td>c_zhxgr</td>
<td>varchar(300)</td>
<td>最后修改人</td>
</tr>
<tr>
<td>dt_cjsj</td>
<td>timestamp</td>
<td>创建时间</td>
</tr>
<tr>
<td>dt_zhxgsj</td>
<td>timestamp</td>
<td>最后修改时间</td>
</tr>
</tbody>
</table>
<p>设计该表的背景是多家法院需要同步基础数据、计算公开节点</p>
<p>抽数接口，传入需要同步的法院id和时间段</p>
<div class="language-java line-numbers-mode" data-ext="java"><pre v-pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DataSyncService</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">syncData</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> jbfys<span class="token punctuation">,</span><span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同步数据入口，记录时间和状态</p>
<div class="language-java line-numbers-mode" data-ext="java"><pre v-pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ZxSjtbjlService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ZxSjtbjlMapper</span> zxSjtbjlMapper<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">syncData</span><span class="token punctuation">(</span><span class="token class-name">String</span> jbfy<span class="token punctuation">,</span><span class="token class-name">String</span> tblx<span class="token punctuation">,</span><span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">,</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> biFunction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"开始数据同步定时任务"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ZxSjtbjl</span> tbjl <span class="token operator">=</span> <span class="token class-name">ZxSjtbjl</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bh</span><span class="token punctuation">(</span><span class="token class-name">UUIDHelper</span><span class="token punctuation">.</span><span class="token function">getUuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
            <span class="token function">tbfy</span><span class="token punctuation">(</span>jbfy<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tblx</span><span class="token punctuation">(</span>tblx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">zt</span><span class="token punctuation">(</span><span class="token class-name">SjtbztEnum</span><span class="token punctuation">.</span><span class="token constant">WTB</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">cjsj</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
            <span class="token class-name">ZxSjtbjl</span> his <span class="token operator">=</span> zxSjtbjlMapper<span class="token punctuation">.</span><span class="token function">selectLastTbjl</span><span class="token punctuation">(</span>tblx<span class="token punctuation">,</span> jbfy<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 默认从2000年开始同步</span>
            <span class="token class-name">LocalDateTime</span> start <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>his<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                start <span class="token operator">=</span> his<span class="token punctuation">.</span><span class="token function">getJssj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token class-name">LocalDateTime</span> end <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            tbjl<span class="token punctuation">.</span><span class="token function">setZt</span><span class="token punctuation">(</span><span class="token class-name">SjtbztEnum</span><span class="token punctuation">.</span><span class="token constant">TBZ</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            tbjl<span class="token punctuation">.</span><span class="token function">setKssj</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">;</span>
            tbjl<span class="token punctuation">.</span><span class="token function">setJssj</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
            tbjl<span class="token punctuation">.</span><span class="token function">setQdsj</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
            zxSjtbjlMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>tbjl<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 同步记录</span>
            <span class="token keyword">int</span> count <span class="token operator">=</span> biFunction<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 更新同步记录</span>
            tbjl<span class="token punctuation">.</span><span class="token function">setTbjls</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            tbjl<span class="token punctuation">.</span><span class="token function">setWcsj</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            tbjl<span class="token punctuation">.</span><span class="token function">setZt</span><span class="token punctuation">(</span><span class="token class-name">SjtbztEnum</span><span class="token punctuation">.</span><span class="token constant">TBWC</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            tbjl<span class="token punctuation">.</span><span class="token function">setZhxgsj</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            zxSjtbjlMapper<span class="token punctuation">.</span><span class="token function">updateByPrimaryKeySelective</span><span class="token punctuation">(</span>tbjl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"同步定时任务失败"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            tbjl<span class="token punctuation">.</span><span class="token function">setZt</span><span class="token punctuation">(</span><span class="token class-name">SjtbztEnum</span><span class="token punctuation">.</span><span class="token constant">TBYC</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            zxSjtbjlMapper<span class="token punctuation">.</span><span class="token function">updateByPrimaryKeySelective</span><span class="token punctuation">(</span>tbjl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>定时任务调用</p>
<div class="language-java line-numbers-mode" data-ext="java"><pre v-pre class="language-java"><code><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"${init.data.corn:0 0 2 * * ?}"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">synchronizeData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"开始从大数据平台同步数据，对接法院：{}"</span><span class="token punctuation">,</span> jbfyStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> corpIdArr <span class="token operator">=</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>jbfyStr<span class="token punctuation">,</span> <span class="token class-name">CommonConstant</span><span class="token punctuation">.</span><span class="token constant">SPLIT_COMMON</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> corpIdList <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>corpIdArr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        corpIdList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>corp <span class="token operator">-></span> sjtbjlService<span class="token punctuation">.</span><span class="token function">syncData</span><span class="token punctuation">(</span>corp<span class="token punctuation">,</span>
                <span class="token class-name">SjtblxEnum</span><span class="token punctuation">.</span><span class="token constant">SJTB</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span> <span class="token operator">-></span> dataSyncService<span class="token punctuation">.</span><span class="token function">syncData</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span>corp<span class="token punctuation">)</span><span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"结束从大数据平台同步数据"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接口如何去实现</p>
<div class="language-java line-numbers-mode" data-ext="java"><pre v-pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">DataSyncAbstractService</span> <span class="token keyword">implements</span> <span class="token class-name">DataSyncService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"initDataExecutor"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">ExecutorService</span> executorService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">syncData</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> jbfys<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"同步数据开始，同步数据的法院为{}，时间区间为:{}-{}"</span><span class="token punctuation">,</span> jbfys<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">LocalDateTime</span> beginSyncTime <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AtomicInteger</span> total <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Callable</span><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">></span><span class="token punctuation">></span></span> callableList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jbfys<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>jbfy <span class="token operator">-></span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token function">syncDataCount</span><span class="token punctuation">(</span>jbfy<span class="token punctuation">,</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
            total<span class="token punctuation">.</span><span class="token function">addAndGet</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"法院{}需要同步的数据案件量为:{},分页案件数为:{}"</span><span class="token punctuation">,</span>jbfy<span class="token punctuation">,</span>count<span class="token punctuation">,</span>syncPageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">double</span> pageCount <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> count <span class="token operator">/</span> syncPageSize<span class="token punctuation">;</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> page <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> page <span class="token operator">&lt;=</span> pageCount<span class="token punctuation">;</span> page<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ajbhs <span class="token operator">=</span> <span class="token function">syncDatas</span><span class="token punctuation">(</span>jbfy<span class="token punctuation">,</span>start<span class="token punctuation">,</span>end<span class="token punctuation">,</span>syncPageSize<span class="token punctuation">,</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>ajbhs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">// 同步数据</span>
                        <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">></span></span> callable <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">{</span>
                            <span class="token function">syncDatasByAjbhs</span><span class="token punctuation">(</span>ajbhs<span class="token punctuation">,</span>start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">;</span>
                        callableList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>callable<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"同步数据异常,同步时间戳为:{}-{}"</span><span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            executorService<span class="token punctuation">.</span><span class="token function">invokeAll</span><span class="token punctuation">(</span>callableList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"同步数据失败，请联系管理员"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Duration</span> dur<span class="token operator">=</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span>beginSyncTime<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"同步全部数据完成，共计用时{}分钟"</span><span class="token punctuation">,</span>dur<span class="token punctuation">.</span><span class="token function">toMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> total<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">syncDatasByAjbhs</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ajbhs<span class="token punctuation">,</span><span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span><span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> ajs <span class="token operator">=</span> <span class="token function">queryAjData</span><span class="token punctuation">(</span>ajbhs<span class="token punctuation">,</span>start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 同步案件数据</span>
        <span class="token function">batchInsertOrUpdateAjInfo</span><span class="token punctuation">(</span>ajs<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 同步当事人数据</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxDsrxx</span><span class="token punctuation">></span></span> dsrs <span class="token operator">=</span> <span class="token function">queryDsrData</span><span class="token punctuation">(</span>ajbhs<span class="token punctuation">,</span>start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>dsrs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 数据库中存在的数据，不需要查出具体的数据信息，只需要查出对应的key</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> syncDsrbhs <span class="token operator">=</span> dsrs<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">BaseEntity</span><span class="token operator">::</span><span class="token function">getBh</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> updateDsrbhs <span class="token operator">=</span>  zxDsrxxMapper<span class="token punctuation">.</span><span class="token function">selectExistsPrimaryKey</span><span class="token punctuation">(</span>syncDsrbhs<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 分组同步数据信息</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">,</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ZxDsrxx</span><span class="token punctuation">></span><span class="token punctuation">></span></span> dataMaps <span class="token operator">=</span> dsrs<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">partitioningBy</span><span class="token punctuation">(</span>dsr<span class="token operator">-></span>updateDsrbhs<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>dsr<span class="token punctuation">.</span><span class="token function">getBh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxDsrxx</span><span class="token punctuation">></span></span> needInsertDsrList <span class="token operator">=</span> dataMaps<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>needInsertDsrList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                needInsertDsrList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>dsr <span class="token operator">-></span> dsr<span class="token punctuation">.</span><span class="token function">setCjsj</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ZxDsrxx</span><span class="token punctuation">></span><span class="token punctuation">></span></span> partition <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span>needInsertDsrList<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">BATCH_NUMBER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                partition<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>list <span class="token operator">-></span> zxDsrxxMapper<span class="token punctuation">.</span><span class="token function">batchInsert</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxDsrxx</span><span class="token punctuation">></span></span> needUpdateDsrList <span class="token operator">=</span> dataMaps<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>needUpdateDsrList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                needInsertDsrList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>dsr <span class="token operator">-></span> dsr<span class="token punctuation">.</span><span class="token function">setZhxgsj</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ZxDsrxx</span><span class="token punctuation">></span><span class="token punctuation">></span></span> partition <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span>needUpdateDsrList<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">BATCH_NUMBER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                partition<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>list <span class="token operator">-></span> zxDsrxxMapper<span class="token punctuation">.</span><span class="token function">batchUpdateByPrimaryKeySelective</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 同步财产信息数据</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxCcxx</span><span class="token punctuation">></span></span> zxccs <span class="token operator">=</span> <span class="token function">queryZxccData</span><span class="token punctuation">(</span>ajbhs<span class="token punctuation">,</span>start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>zxccs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 数据库中存在的数据，不需要查出具体的数据信息，只需要查出对应的key</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> syncZxccbhs <span class="token operator">=</span> zxccs<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">BaseEntity</span><span class="token operator">::</span><span class="token function">getBh</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> updateZxccbhs <span class="token operator">=</span>  zxCcxxMapper<span class="token punctuation">.</span><span class="token function">selectExistsPrimaryKey</span><span class="token punctuation">(</span>syncZxccbhs<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 分组同步数据信息</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">,</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ZxCcxx</span><span class="token punctuation">></span><span class="token punctuation">></span></span> dataMaps <span class="token operator">=</span> zxccs<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">partitioningBy</span><span class="token punctuation">(</span>zxcc<span class="token operator">-></span>updateZxccbhs<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>zxcc<span class="token punctuation">.</span><span class="token function">getBh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxCcxx</span><span class="token punctuation">></span></span> needInsertCcxxList <span class="token operator">=</span> dataMaps<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>needInsertCcxxList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                needInsertCcxxList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>ccxx <span class="token operator">-></span> ccxx<span class="token punctuation">.</span><span class="token function">setCjsj</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ZxCcxx</span><span class="token punctuation">></span><span class="token punctuation">></span></span> partition <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span>needInsertCcxxList<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">BATCH_NUMBER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                partition<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>list <span class="token operator">-></span> zxCcxxMapper<span class="token punctuation">.</span><span class="token function">batchInsert</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxCcxx</span><span class="token punctuation">></span></span> needUpdateCcxxList <span class="token operator">=</span> dataMaps<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>needUpdateCcxxList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                needUpdateCcxxList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>ccxx <span class="token operator">-></span> ccxx<span class="token punctuation">.</span><span class="token function">setZhgxsj</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ZxCcxx</span><span class="token punctuation">></span><span class="token punctuation">></span></span> partition <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span>needUpdateCcxxList<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">BATCH_NUMBER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                partition<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>list <span class="token operator">-></span> zxCcxxMapper<span class="token punctuation">.</span><span class="token function">batchUpdateByPrimaryKeySelective</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * DataSyncAbstractService
     *
     * <span class="token keyword">@description</span> 批量插入或更新案件信息
     * <span class="token keyword">@param</span> <span class="token parameter">ajs</span> 案件集合
     * <span class="token keyword">@author</span> XieZhongCai
     * <span class="token keyword">@date</span> 2023/5/24 19:29
     * <span class="token keyword">@version</span> V1.0.0
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">batchInsertOrUpdateAjInfo</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> ajs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>ajs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 大数据平台需要处理实体码，才能变成可以入库的案件编号</span>
            ajs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>aj <span class="token operator">-></span> aj<span class="token punctuation">.</span><span class="token function">setBh</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>aj<span class="token punctuation">.</span><span class="token function">getBh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 数据库中存在的数据，不需要查出具体的数据信息，只需要查出对应的key</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> syncAjbhs <span class="token operator">=</span> ajs<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">BaseEntity</span><span class="token operator">::</span><span class="token function">getBh</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> updateAjbhs <span class="token operator">=</span>  zxAjMapper<span class="token punctuation">.</span><span class="token function">selectExistsPrimaryKey</span><span class="token punctuation">(</span>syncAjbhs<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 分组同步数据信息</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">,</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span><span class="token punctuation">></span></span> dataMaps <span class="token operator">=</span> ajs<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">partitioningBy</span><span class="token punctuation">(</span>aj<span class="token operator">-></span>updateAjbhs<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>aj<span class="token punctuation">.</span><span class="token function">getBh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> needInsertList <span class="token operator">=</span> dataMaps<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>needInsertList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                needInsertList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>aj <span class="token operator">-></span> aj<span class="token punctuation">.</span><span class="token function">setCjsj</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                zxAjMapper<span class="token punctuation">.</span><span class="token function">batchInsert</span><span class="token punctuation">(</span>needInsertList<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> needUpdateList <span class="token operator">=</span> dataMaps<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>needUpdateList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                needInsertList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>aj <span class="token operator">-></span> aj<span class="token punctuation">.</span><span class="token function">setZhxgsj</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                zxAjMapper<span class="token punctuation">.</span><span class="token function">batchUpdateByPrimaryKeySelective</span><span class="token punctuation">(</span>needUpdateList<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">int</span> <span class="token function">syncDataCount</span><span class="token punctuation">(</span><span class="token class-name">String</span> jbfy<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">syncDatas</span><span class="token punctuation">(</span><span class="token class-name">String</span> jbfy<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span><span class="token class-name">LocalDateTime</span> end<span class="token punctuation">,</span><span class="token keyword">int</span> pagesize<span class="token punctuation">,</span><span class="token keyword">int</span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> <span class="token function">queryAjData</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ajbhs<span class="token punctuation">,</span><span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span><span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxDsrxx</span><span class="token punctuation">></span></span> <span class="token function">queryDsrData</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ajbhs<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxCcxx</span><span class="token punctuation">></span></span> <span class="token function">queryZxccData</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ajbhs<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>考虑到数据来源会有多种，用抽象类提取了公共方法，模板模式运用其中</p>
<p>其中一种实现方式</p>
<div class="language-java line-numbers-mode" data-ext="java"><pre v-pre class="language-java"><code><span class="token doc-comment comment">/**
 * HyDsjptDataSyncServiceImpl
 *
 * <span class="token keyword">@description</span> 华宇大数据平台同步数据
 * <span class="token keyword">@author</span> XieZhongCai
 * <span class="token keyword">@date</span> 2023/5/23 17:43
 * <span class="token keyword">@version</span> v1.0.0
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"data"</span><span class="token punctuation">,</span> havingValue <span class="token operator">=</span> <span class="token string">"hydsjpt"</span><span class="token punctuation">,</span> matchIfMissing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"from"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HyDsjptDataSyncServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">DataSyncAbstractService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">SjzxZxAjMapper</span> sjzxZxAjMapper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">SjzxDsrxxMapper</span> sjzxDsrxxMapper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">SjzxCcxxMapper</span> sjzxCcxxMapper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CcxxService</span> ccxxService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostConstruct</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token constant">CCMX_HANDLE_SERVICE_MAP</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ECclx</span><span class="token punctuation">.</span><span class="token constant">HBXJ</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sjzxCcxxMapper<span class="token operator">::</span><span class="token function">listXjByWybs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">int</span> <span class="token function">syncDataCount</span><span class="token punctuation">(</span><span class="token class-name">String</span> jbfy<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 与大连大数据平台研发团队确认，因为上报是以案件为维度的，所以只要案件相关的任何信息发生变化，都会驱使案件重新导出然后入法标库，所以案件的更新时间就会跟着发生变化</span>
        <span class="token keyword">return</span> sjzxZxAjMapper<span class="token punctuation">.</span><span class="token function">countNeedUpdateAj</span><span class="token punctuation">(</span>jbfy<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">syncDatas</span><span class="token punctuation">(</span><span class="token class-name">String</span> jbfy<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">,</span> <span class="token keyword">int</span> pagesize<span class="token punctuation">,</span> <span class="token keyword">int</span> page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 与大连大数据平台研发团队确认，因为上报是以案件为维度的，所以只要案件相关的任何信息发生变化，都会驱使案件重新导出然后入法标库，所以案件的更新时间就会跟着发生变化</span>
        <span class="token keyword">return</span> sjzxZxAjMapper<span class="token punctuation">.</span><span class="token function">listNeedUpdateAjbh</span><span class="token punctuation">(</span>jbfy<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> pagesize<span class="token punctuation">,</span> page <span class="token operator">*</span> pagesize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> <span class="token function">queryAjData</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ajbhs<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> zxAjList <span class="token operator">=</span> sjzxZxAjMapper<span class="token punctuation">.</span><span class="token function">listByPrimaryKey</span><span class="token punctuation">(</span>ajbhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 计算终本状态并将关联的执恢案件入库</span>
        <span class="token function">calcZbzt</span><span class="token punctuation">(</span>zxAjList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> zxAjList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 计算终本状态
     * <span class="token keyword">@param</span> <span class="token parameter">zxAjList</span> 首执案件集合
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">calcZbzt</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> zxAjList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> hfzxAjResultList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>zxAjList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 计算终本状态</span>
        zxAjList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>szaj <span class="token operator">-></span> <span class="token punctuation">{</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> bhs <span class="token operator">=</span> sjzxZxAjMapper<span class="token punctuation">.</span><span class="token function">listZxhfAjbhsByYsaj</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span>szaj<span class="token punctuation">.</span><span class="token function">getBh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 终本中情况一：首执终本的案件无执恢案件和关联的执恢案件结案方式是终本的</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>bhs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                szaj<span class="token punctuation">.</span><span class="token function">setZbzt</span><span class="token punctuation">(</span><span class="token class-name">EZbzt</span><span class="token punctuation">.</span><span class="token constant">ZBZ</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 首执案件下面的执恢案件编号集合</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> zxhfAjbhs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>bhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">findNextHfzxAjbh</span><span class="token punctuation">(</span>bhs<span class="token punctuation">,</span> zxhfAjbhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxAj</span><span class="token punctuation">></span></span> hfzxAjList <span class="token operator">=</span> sjzxZxAjMapper<span class="token punctuation">.</span><span class="token function">listHfzxByPrimaryKey</span><span class="token punctuation">(</span>zxhfAjbhs<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 设置执恢案件对应的首执案件编号，方便在页面上进行关联查询</span>
            hfzxAjList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>hfzx <span class="token operator">-></span> hfzx<span class="token punctuation">.</span><span class="token function">setSzajbh</span><span class="token punctuation">(</span>szaj<span class="token punctuation">.</span><span class="token function">getBh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 页面上展示最新的一条执恢记录的案号和结案日期、恢复次数</span>
            szaj<span class="token punctuation">.</span><span class="token function">setHfcs</span><span class="token punctuation">(</span>hfzxAjList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            hfzxAjList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparing</span><span class="token punctuation">(</span><span class="token class-name">ZxAj</span><span class="token operator">::</span><span class="token function">getLarq</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span>lastHfzx <span class="token operator">-></span> <span class="token punctuation">{</span>
                szaj<span class="token punctuation">.</span><span class="token function">setZbhfAh</span><span class="token punctuation">(</span>lastHfzx<span class="token punctuation">.</span><span class="token function">getAh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                szaj<span class="token punctuation">.</span><span class="token function">setZbhfJarq</span><span class="token punctuation">(</span>lastHfzx<span class="token punctuation">.</span><span class="token function">getJarq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                szaj<span class="token punctuation">.</span><span class="token function">setZhsqbdje</span><span class="token punctuation">(</span>lastHfzx<span class="token punctuation">.</span><span class="token function">getSqzxje</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                szaj<span class="token punctuation">.</span><span class="token function">setZhlarq</span><span class="token punctuation">(</span>lastHfzx<span class="token punctuation">.</span><span class="token function">getLarq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            hfzxAjResultList<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>hfzxAjList<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 终本中情况二：首执终本的案件关联的执恢案件结案方式是终本的</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>hfzxAjList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">allMatch</span><span class="token punctuation">(</span>hfzx <span class="token operator">-></span> <span class="token class-name">EZxhfJafs</span><span class="token punctuation">.</span><span class="token constant">ZJBCCZXCX</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>hfzx<span class="token punctuation">.</span><span class="token function">getJafs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                szaj<span class="token punctuation">.</span><span class="token function">setZbzt</span><span class="token punctuation">(</span><span class="token class-name">EZbzt</span><span class="token punctuation">.</span><span class="token constant">ZBZ</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 恢复中：首执终本的案件关联的执恢案件有在办中（有立案日期但无结案日期）</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>hfzxAjList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">anyMatch</span><span class="token punctuation">(</span>hfzx <span class="token operator">-></span> hfzx<span class="token punctuation">.</span><span class="token function">getLarq</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> hfzx<span class="token punctuation">.</span><span class="token function">getJarq</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                szaj<span class="token punctuation">.</span><span class="token function">setZbzt</span><span class="token punctuation">(</span><span class="token class-name">EZbzt</span><span class="token punctuation">.</span><span class="token constant">HFZ</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 已实结：首执终本的案件关联的执恢案件结案方式是执行完毕和终结执行</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>hfzxAjList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">anyMatch</span><span class="token punctuation">(</span>hfzx <span class="token operator">-></span> <span class="token class-name">EZxhfJafs</span><span class="token punctuation">.</span><span class="token constant">ZXWB</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>hfzx<span class="token punctuation">.</span><span class="token function">getJafs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token operator">||</span> <span class="token class-name">EZxhfJafs</span><span class="token punctuation">.</span><span class="token constant">ZJZX</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>hfzx<span class="token punctuation">.</span><span class="token function">getJafs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                szaj<span class="token punctuation">.</span><span class="token function">setZbzt</span><span class="token punctuation">(</span><span class="token class-name">EZbzt</span><span class="token punctuation">.</span><span class="token constant">SJZ</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 恢复执行案件集合入库</span>
        <span class="token function">batchInsertOrUpdateAjInfo</span><span class="token punctuation">(</span>hfzxAjResultList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 递归查询首执案件下面的执恢案件编号集合
     * <span class="token keyword">@param</span> <span class="token parameter">params</span> 原审案件
     * <span class="token keyword">@param</span> <span class="token parameter">resultSet</span> 执恢案件编号集合
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">findNextHfzxAjbh</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> params<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> resultSet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> newBhs <span class="token operator">=</span> sjzxZxAjMapper<span class="token punctuation">.</span><span class="token function">listZxhfAjbhsByYsaj</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
            resultSet<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>newBhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">findNextHfzxAjbh</span><span class="token punctuation">(</span>newBhs<span class="token punctuation">,</span> resultSet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxDsrxx</span><span class="token punctuation">></span></span> <span class="token function">queryDsrData</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ajbhs<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> sjzxDsrxxMapper<span class="token punctuation">.</span><span class="token function">listDsrxxByAjbhs</span><span class="token punctuation">(</span>ajbhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxCcxx</span><span class="token punctuation">></span></span> <span class="token function">queryZxccData</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ajbhs<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> start<span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1. 拿到案件下面的调查信息</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CcDcxx</span><span class="token punctuation">></span></span> dcxxList <span class="token operator">=</span> sjzxCcxxMapper<span class="token punctuation">.</span><span class="token function">listDcxxByAjbhs</span><span class="token punctuation">(</span>ajbhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>dcxxList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">CcDcxx</span><span class="token punctuation">></span><span class="token punctuation">></span></span> cclxAndDcxxList <span class="token operator">=</span> dcxxList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">CcDcxx</span><span class="token operator">::</span><span class="token function">getCclx</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2. 分类型获取对应财产的详细信息</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxccDto</span><span class="token punctuation">></span></span> needInsertOrUpdateCc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">handleCcmxByCclx</span><span class="token punctuation">(</span>cclxAndDcxxList<span class="token punctuation">,</span> needInsertOrUpdateCc<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 3. 根据必填字段生成明细json、处理名称、可用余额、证件号码、同证件做更新</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxCcxx</span><span class="token punctuation">></span></span> zxCcxxes <span class="token operator">=</span> ccxxService<span class="token punctuation">.</span><span class="token function">convertToZxCcxx</span><span class="token punctuation">(</span>needInsertOrUpdateCc<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 4. 获取财产对应的查控类措施信息和处分类措施信息最新记录</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ccbhs <span class="token operator">=</span> zxCcxxes<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">ZxCcxx</span><span class="token operator">::</span><span class="token function">getBh</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>ccbhs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CcCkCf</span><span class="token punctuation">></span></span> ccCkCfs<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ccbhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">BATCH_NUMBER</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                ccCkCfs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>ccbhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span><span class="token punctuation">></span></span> partition <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span>ccbhs<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">BATCH_NUMBER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                partition<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>list <span class="token operator">-></span> ccCkCfs<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>sjzxCcxxMapper<span class="token punctuation">.</span><span class="token function">listCkCfCsxxByCcbhs</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>ccbhs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                ccCkCfs <span class="token operator">=</span> sjzxCcxxMapper<span class="token punctuation">.</span><span class="token function">listCkCfCsxxByCcbhs</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>ccbhs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>ccCkCfs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">CcCkCf</span><span class="token punctuation">></span></span> ckCfMap <span class="token operator">=</span> ccCkCfs<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">CcCkCf</span><span class="token operator">::</span><span class="token function">getCcbh</span><span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token punctuation">.</span><span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                zxCcxxes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>ccxx <span class="token operator">-></span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>ckCfMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ccxx<span class="token punctuation">.</span><span class="token function">getBh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span>ckCf <span class="token operator">-></span> <span class="token punctuation">{</span>
                            ccxx<span class="token punctuation">.</span><span class="token function">setCczt</span><span class="token punctuation">(</span>ckCf<span class="token punctuation">.</span><span class="token function">getCczt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            ccxx<span class="token punctuation">.</span><span class="token function">setKzqsrq</span><span class="token punctuation">(</span>ckCf<span class="token punctuation">.</span><span class="token function">getKzqsrq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            ccxx<span class="token punctuation">.</span><span class="token function">setKzjmrq</span><span class="token punctuation">(</span>ckCf<span class="token punctuation">.</span><span class="token function">getKzjmrq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            ccxx<span class="token punctuation">.</span><span class="token function">setCccfbxrq</span><span class="token punctuation">(</span>ckCf<span class="token punctuation">.</span><span class="token function">getCccfbxrq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            ccxx<span class="token punctuation">.</span><span class="token function">setZxsdccjz</span><span class="token punctuation">(</span>ckCf<span class="token punctuation">.</span><span class="token function">getZxsdccjz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> zxCcxxes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 分类型获取对应财产的详细信息
     * <span class="token keyword">@param</span> <span class="token parameter">cclxAndDcxxList</span> 财产类型对应的处理方法
     * <span class="token keyword">@param</span> <span class="token parameter">needInsertOrUpdateCc</span> 结果集
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">handleCcmxByCclx</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">CcDcxx</span><span class="token punctuation">></span><span class="token punctuation">></span></span> cclxAndDcxxList<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZxccDto</span><span class="token punctuation">></span></span> needInsertOrUpdateCc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cclxAndDcxxList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>cclx<span class="token punctuation">,</span> list<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">{</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> wybsSet <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">CcDcxx</span><span class="token operator">::</span><span class="token function">getWybs</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">CcDcxx</span><span class="token punctuation">></span></span> wybsMap <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">CcDcxx</span><span class="token operator">::</span><span class="token function">getWybs</span><span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token punctuation">.</span><span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>existing<span class="token punctuation">,</span> replacement<span class="token punctuation">)</span> <span class="token operator">-></span> existing<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 根据调用类型和参数调用对应的服务函数</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> mxList <span class="token operator">=</span> <span class="token constant">CCMX_HANDLE_SERVICE_MAP</span><span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>cclx<span class="token punctuation">,</span> <span class="token punctuation">(</span>bhs<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>wybsSet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>mxList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                needInsertOrUpdateCc<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>mxList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>mx <span class="token operator">-></span> <span class="token punctuation">{</span>
                    <span class="token class-name">BaseCcxx</span> ccMxxx <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BaseCcxx</span><span class="token punctuation">)</span> mx<span class="token punctuation">;</span>
                    <span class="token class-name">CcDcxx</span> ccDcxx <span class="token operator">=</span> wybsMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ccMxxx<span class="token punctuation">.</span><span class="token function">getCcWybs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>ccDcxx <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token class-name">ZxCcxx</span> common <span class="token operator">=</span> <span class="token class-name">ZxCcxx</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">bh</span><span class="token punctuation">(</span>ccMxxx<span class="token punctuation">.</span><span class="token function">getBh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">ccsyrmc</span><span class="token punctuation">(</span>ccDcxx<span class="token punctuation">.</span><span class="token function">getCcsyrMc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">cclx</span><span class="token punctuation">(</span>ccDcxx<span class="token punctuation">.</span><span class="token function">getCclx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">zjhm</span><span class="token punctuation">(</span>ccMxxx<span class="token punctuation">.</span><span class="token function">getCcZjhm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">bhAj</span><span class="token punctuation">(</span>ccDcxx<span class="token punctuation">.</span><span class="token function">getAjbh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">bhCcsyr</span><span class="token punctuation">(</span>ccDcxx<span class="token punctuation">.</span><span class="token function">getCcsyr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">djrq</span><span class="token punctuation">(</span>ccDcxx<span class="token punctuation">.</span><span class="token function">getCcdjrq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">ccxxly</span><span class="token punctuation">(</span>ccDcxx<span class="token punctuation">.</span><span class="token function">getCcdcfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token comment">// 默认财产状态为正常，后面如果获取到查控、处分类措施会更改状态</span>
                            <span class="token punctuation">.</span><span class="token function">cczt</span><span class="token punctuation">(</span><span class="token class-name">ECczt</span><span class="token punctuation">.</span><span class="token constant">ZC</span><span class="token punctuation">.</span><span class="token function">getZt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">ZxccDto</span> zxccDto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZxccDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    zxccDto<span class="token punctuation">.</span><span class="token function">setCommon</span><span class="token punctuation">(</span>common<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    zxccDto<span class="token punctuation">.</span><span class="token function">setFieldValue</span><span class="token punctuation">(</span>zxccDto<span class="token punctuation">,</span> <span class="token class-name">ECclx</span><span class="token punctuation">.</span><span class="token function">getVariableName</span><span class="token punctuation">(</span>cclx<span class="token punctuation">)</span><span class="token punctuation">,</span> mx<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> zxccDto<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></template>


